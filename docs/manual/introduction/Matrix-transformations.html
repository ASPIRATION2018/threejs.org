<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<base href="../../" />
		<script src="list.js"></script>
		<script src="page.js"></script>
		<link type="text/css" rel="stylesheet" href="page.css" />
	</head>
	<body>
		<h1>矩阵变换[name]</h1>

		<p>
		Three.js使用矩阵来描述三维中的变换---（位置）平移，旋转以及缩放。每个三维对象[page:Object3D]的实例都有一个矩阵[page:Object3D.matrix matrix]来保存该对象的位置、旋转以及缩放。本节说明了如何更新变换矩阵。
		</p>

		<h2>快捷属性 和 *matrixAutoUpdate*</h2>

		有两种方法可以更新物体的变换矩阵：

		<ol>
			<li>
				修改物体的 坐标*position*, 四元数*quaternion*, 以及缩放 *scale* 属性，然后Three.js通过以下属性重新计算对象的矩阵。
				<code>
				object.position.copy(start_position);
				object.quaternion.copy(quaternion);
				</code>
				matrixAutoUpdate的默认值为true，这样对象的矩阵会自动重新计算。
				如果物体没有发生变换，或者你希望在产生变换时手动控制更新，把matrixAutoUpdate的值设为false可以获得更好的性能。
				<code>
				object.matrixAutoUpdate = false;
				</code>
				那么当修改对象属性时，手动更新矩阵：
				<code>
				object.updateMatrix();
				</code>
			</li>
			<li>
				直接修改对象的矩阵。矩阵[page:Matrix4]类提供了多个方法修改矩阵：
				<code>
				object.matrix.setRotationFromQuaternion(quaternion);
				object.matrix.setPosition(start_position);
				object.matrixAutoUpdate = false;
				</code>
				注意，这种情况下*matrixAutoUpdate*属性<em>必须</em>被设置为*false*，并且确保<em>不能</em>调用*updateMatrix*方法。因为调用*updateMatrix*方法会引起矩阵的重新计算，从而覆盖手动的修改。
			</li>
		</ol>

		<h2>对象和世界矩阵</h2>
		<p>
		对象的[page:Object3D.matrix matrix]属性保存的是该对象<em>相对</em>其父对象[page:Object3D.parent parent]的变换矩阵，该对象相对<em>世界坐标</em>的变换矩阵保存在对象的matrixWorld属性里（[page:Object3D.matrixWorld]）。
		</p>
		<p>
		当父对象或子对象发生变换时，可以通过调用子对象的[page:Object3D.updateMatrixWorld updateMatrixWorld]()方法来更新[page:Object3D.matrixWorld matrixWorld]属性。
		</p>

		<h2>旋转和四元数</h2>
		<p>
		Three.js提供两种方法来表示三维旋转：欧拉角[page:Euler Euler angles] 以及 四元数[page:Quaternion Quaternions]，以及二者之间的转换方法。欧拉角会有“万向节死锁”的问题，即在某些特定角度会导致某个维度的旋转变换失效。因此，对象的旋转<em>总是</em>用四元数[page:Object3D.quaternion quaternion]来表示。
		</p>
		<p>
		之前的版本中的*useQuaternion*属性设为false时，会导致对象通过欧拉角计算变换矩阵[page:Object3D.matrix matrix]。目前该属性已经被废弃并被[page:Object3D.setRotationFromEuler setRotationFromEuler]方法替代，该方法通过四元数计算矩阵。
		</p>

	</body>
</html>
